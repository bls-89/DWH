1)SELECT c.FirstName, c.LastName, SUM(o.TotalAmount) as Total
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
GROUP BY c.CustomerID
ORDER BY Total DESC


2)SELECT c.FirstName, c.LastName, o.OrderID, o.TotalAmount
FROM (
    SELECT CustomerID, SUM(TotalAmount) as Total
    FROM Orders
    GROUP BY CustomerID
) as s
JOIN Customers c ON c.CustomerID = s.CustomerID
JOIN Orders o ON o.CustomerID = s.CustomerID
ORDER BY s.Total DESC, o.TotalAmount DESC

3)SELECT FirstName, LastName
FROM Customers
WHERE CustomerID IN (
    SELECT CustomerID
    FROM Orders
    GROUP BY CustomerID
    HAVING SUM(TotalAmount) > (
        SELECT AVG(TotalAmount)
        FROM Orders))

